# Caddy Webserver config file

import helpers/*

apt.woomy.ovh {
	import log apt.woomy.ovh
	handle {
		root * /home/woomy/Services/Debian-repo
		file_server
	}
	handle /browser {
		redir https://apt.woomy.ovh/browser/ permanent
 	}
	handle_path /browser/* {
		root * /home/woomy/Services/Debian-repo
		file_server browse {
			index no.html
			hide index.html
		}
	}
}

files.woomy.ovh www.files.woomy.ovh {
	import log files.woomy.ovh
	handle {
		root * /home/woomy/Services/files.woomy.ovh
		file_server browse
	}
	
	handle /joplin_browser {
		redir https://files.woomy.ovh/joplin_browser/ permanent
	}
	
	handle_path /joplin_browser/* {
		root * /home/woomy/Services/files.woomy.ovh/joplin_bin
		file_server browse {
			index no.html # To prevent rendering index
			hide index.html
		}
	}
}

gitea.woomy.ovh www.gitea.woomy.ovh {
	import log gitea.woomy.ovh
	reverse_proxy localhost:3000
}

bitwarden.woomy.ovh www.bitwarden.woomy.ovh {
	import log bitwarden.woomy.ovh
	reverse_proxy localhost:8080
}

nextcloud.woomy.ovh www.nextcloud.woomy.ovh {
	import log nextcloud.woomy.ovh
	header "Strict-Transport-Security" "max-age=15552000; includeSubDomains"
	reverse_proxy localhost:8000
}

rss.woomy.ovh www.rss.woomy.ovh {
	import log rss.woomy.ovh
	reverse_proxy localhost:8888
}
